(function(){var e={4787:function(e,t,r){"use strict";var o=r(9003),a=r(2483);const n=(0,o._)("h3",null,"机器人通信Dome(通信方式不要按照我这种来，最好采用通讯池的方式，接收和发送都在通讯池中处理)",-1),l=(0,o._)("p",null,"通讯格式为:帧头、数据长度、指令、数据、校验位 ",-1);function s(e,t,r,a,s,i){const u=(0,o.up)("el-button");return(0,o.wg)(),(0,o.iD)("div",null,[n,l,(0,o.Wm)(u,{type:"primary",onClick:t[0]||(t[0]=e=>i.GO_Convoy_Seven())},{default:(0,o.w5)((()=>[(0,o.Uk)("变七")])),_:1}),(0,o.Wm)(u,{type:"primary",onClick:t[1]||(t[1]=e=>i.GO_Bumblebee())},{default:(0,o.w5)((()=>[(0,o.Uk)("大黄蜂")])),_:1}),(0,o.Wm)(u,{type:"primary",onClick:t[2]||(t[2]=e=>i.GO_SteelCable())},{default:(0,o.w5)((()=>[(0,o.Uk)("钢索")])),_:1})])}var i=r(4693),u=r.n(i),c={data(){return{msg:"aaa",ports:[]}},methods:{async requestSerialPort(){try{const e=await navigator.serial.requestPort();console.log(e)}catch(e){console.error(e)}},async getSerialPorts(){try{this.ports=await navigator.serial.getPorts(),console.log(this.ports)}catch(e){console.error(e)}},GO_Convoy_Seven(){this.$router.replace("/Convoy_Seven")},GO_Bumblebee(){this.$router.replace("/Bumblebee")},async GO_SteelCable(){this.$router.replace("/SteelCable")},async f(){var e=[0,1,2,3,4,9,6,7,8,10];for(let o=0;o<e.length;o++)if(5==o){e.splice(o,5);break}var t=Array.from(u().encode("VolleyAction/1","utf8")),r=Array.from(u().encode("VolleyAction/1","gb2312"));console.log(t),console.log(r)}},mounted(){}},p=r(89);const h=(0,p.Z)(c,[["render",s]]);var f=h;const w=(0,o._)("h3",null,"变七机器人通讯结构",-1),_=(0,o._)("p",null,"连接方式 : 串口",-1),m=(0,o._)("p",null,"配置参数baudRate : 115200",-1),d=(0,o._)("p",null,"配置参数parity : 0",-1),g=(0,o._)("p",null,"配置参数dataBits : 8",-1),b=(0,o._)("p",null,"配置参数stopBits : 1",-1),v=(0,o._)("label",null,[(0,o.Uk)(" 连接成功后，发送[0xFF, 0xFF, 0x02, 0xF5, 0xF7] 指令0xF5是进入PC编程模式 0xF7是(指令+数据)和%256的结果 "),(0,o._)("br"),(0,o.Uk)(" 发送后接收数据直到接收[0xFF,0xFF,0x04 0xF4,0x4F 0x4B,0x93] 当中的数据需要进行处理")],-1),y=(0,o._)("p",null,null,-1),k=(0,o._)("label",null,"关闭需要发送指令 [0xFF, 0xFF, 0x02, 0xF6, 0xF8] 然后断开端口",-1),P=(0,o._)("p",null,null,-1),L=(0,o._)("label",null,"例如:左肩旋转: ",-1),I=(0,o._)("label",null,"控制舵机移动[0xFF,0xFF,数据长度,指令(0x01),数据(位置+速度),sum和]指定左肩的下标控制",-1),M=(0,o._)("p",null,null,-1),F=(0,o._)("label",null,"初始位置在人形的时候就已经读取过，具体是那个看代码，保存指令为[0xFF,0xFF,数据长度,指令(0x03) 数据,sum和] 更改方式也是指定的某个轴的下标",-1),S=(0,o._)("p",null,null,-1),x=(0,o._)("label",null,"初始位置在人形的时候就已经读取过，具体是那个看代码，保存指令为[0xFF,0xFF,数据长度,指令(0x0F) 数据,sum和] 更改方式也是指定的某个轴的下标",-1),A=(0,o._)("p",null,null,-1),D=(0,o._)("p",null,null,-1),U=(0,o._)("label",null,"下载是将pc上的数据载入到机器人当中，这里用一个.shr机器人保存再本地的文件开始,下载的指令顺序是:删除(0x15),创建(0x14),修改(0x17),下载(0x02)",-1),N=(0,o._)("p",null,null,-1),C=(0,o._)("label",null,"这个地方有个bug就是文件名是数字且这个数字小于10的情况下发送到机器人的数据会多一个具体原因不明(感觉是机器人内部处理的问题，用纯PC的软件不会)",-1),T=(0,o._)("p",null,null,-1),O=(0,o._)("h4",null,"上传功能",-1),W=(0,o._)("label",null,"上传功能首先需要读取一下机器人内部的上传动作文件名",-1),B=(0,o._)("p",null,null,-1),E=(0,o._)("label",null,"以绝对路径读取文件夹指令为[0xFF,0xFF,数据长度,指令(0x1A) 数据,sum和]",-1),R=(0,o._)("p",null,null,-1),q=(0,o._)("label",null,"上传，先选择要上传的文件，然后发送指令[0xFF,0xFF,数据长度,指令(0x16),0x3B,(固定数据) 数据(文件名称数据),sum和]",-1);function V(e,t,r,a,n,l){const s=(0,o.up)("el-button"),i=(0,o.up)("el-input"),u=(0,o.up)("el-option"),c=(0,o.up)("el-select");return(0,o.wg)(),(0,o.iD)(o.HY,null,[w,_,m,d,g,b,(0,o.Wm)(s,{type:"primary",onClick:t[0]||(t[0]=e=>l.requestSerialPort())},{default:(0,o.w5)((()=>[(0,o.Uk)("连接")])),_:1}),v,y,(0,o.Wm)(s,{type:"primary",onClick:t[1]||(t[1]=e=>l.closePose())},{default:(0,o.w5)((()=>[(0,o.Uk)("关闭")])),_:1}),k,P,(0,o.Wm)(s,{type:"primary",onClick:t[2]||(t[2]=e=>l.timeSendingPosition())},{default:(0,o.w5)((()=>[(0,o.Uk)("时时发送位置")])),_:1}),L,(0,o.Wm)(i,{modelValue:n.ArmInput,"onUpdate:modelValue":t[3]||(t[3]=e=>n.ArmInput=e),style:{width:"50px"}},null,8,["modelValue"]),I,M,(0,o.Wm)(s,{type:"primary",onClick:t[4]||(t[4]=e=>l.humanoidInitial())},{default:(0,o.w5)((()=>[(0,o.Uk)("人形初始位置保存")])),_:1}),F,S,(0,o.Wm)(s,{type:"primary",onClick:t[5]||(t[5]=e=>l.squatStart())},{default:(0,o.w5)((()=>[(0,o.Uk)("下蹲初始位置")])),_:1}),x,A,(0,o._)("input",{type:"file",onChange:t[6]||(t[6]=(...e)=>l.actionDownload&&l.actionDownload(...e))},null,32),(0,o.Uk)(" 下载功能 "),D,U,N,C,T,O,W,B,(0,o.Wm)(s,{type:"primary",onClick:t[7]||(t[7]=e=>l.getActionName())},{default:(0,o.w5)((()=>[(0,o.Uk)("读取")])),_:1}),(0,o.Wm)(c,{modelValue:n.selectedOption,"onUpdate:modelValue":t[8]||(t[8]=e=>n.selectedOption=e)},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(n.vOpentions,(e=>((0,o.wg)(),(0,o.j4)(u,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),E,R,(0,o.Wm)(s,{type:"primary",onClick:t[9]||(t[9]=e=>l.getAction())},{default:(0,o.w5)((()=>[(0,o.Uk)(" 上传")])),_:1}),q],64)}r(1439),r(7585),r(5315),r(7658);class j{constructor({number:e,Name:t,Pos:r,Speed:o,Delay:a,Loop_Time:n,Is_Loop_Start:l,Is_Loop_End:s,Music_State:i,Music_Number:u}){this.number=e,this.Name=t,this.Pos=r,this.Speed=o,this.Delay=a,this.Loop_Time=n,this.Is_Loop_Start=l,this.Is_Loop_End=s,this.Music_State=i,this.Music_Number=u}}function G(e){return new j({number:e.number,Name:e.Name,Pos:e.Pos,Speed:e.Speed,Delay:e.Delay,Loop_Time:e.Loop_Time,Is_Loop_Start:e.Is_Loop_Start,Is_Loop_End:e.Is_Loop_End,Music_State:e.Music_State,Music_Number:e.Music_Number})}var H={data(){return{port:{},isLink:!1,initData:[],ArmInput:0,dataArr:[],selectedOption:"",vOpentions:[]}},methods:{async requestSerialPort(){try{const a=await navigator.serial.requestPort();if(null!=a){await a.open({baudRate:115200,parity:"none",dataBits:8,stopBits:1}),this.port=a;const n=new Uint8Array([255,255,2,245,247]),l=a.writable.getWriter();await l.write(n),await l.releaseLock();const s=await a.readable.getReader();this.isLink=!1;var e=[];while(1){if(1==this.isLink){s.releaseLock();break}const{value:o,done:a}=await s.read();if(a){s.releaseLock();break}for(let t=0;t<o.length;t++)e[e.length]=o[t];for(let n=0;n<e.length;n++)if(255==e[n]&&255==e[n+1]){var t=e[n+2],r=e[n+3];if(4==t&&245==r&&79==e[n+4]&&75==e[n+5]&&e[n+6]==(t+r+79+75)%256){this.isLink=!0;break}}}let i=0;for(let a=0;a<e.length;a++)if(255==e[a]&&255==e[a+1]){t=e[a+2],r=e[a+3];if(50==t&&245==r){var o=[];for(let t=0;t<48;t++)o[t]=e[a+t+4];a+=52,this.initData[i]=o,i++}}}}catch(a){console.error(a)}},async closePose(){try{const e=new Uint8Array([255,255,2,246,248]),t=this.port.writable.getWriter();await t.write(e),this.isLink=!1}catch(e){console.error(e)}},async timeSendingPosition(){try{if(1==this.isLink){var e=this.initData[0];e[12]+=parseInt(this.ArmInput),e[e.length]=25;var t=[];t[0]=255,t[1]=255,t[2]=51,t[3]=1;var r=52;for(let o=0;o<e.length;o++)t[4+o]=e[o],r+=e[o];r%=256,t[t.length]=r;var o=new Uint8Array(t);const a=this.port.writable.getWriter();await a.write(o),await a.releaseLock()}}catch(a){console.error(a)}},async humanoidInitial(){try{if(1==this.isLink){var e=this.initData[0],t=[];t[0]=255,t[1]=255,t[2]=50,t[3]=3;var r=53;for(let o=0;o<e.length;o++)t[4+o]=e[o],r+=e[o];r%=256,t[t.length]=r,console.log(t);var o=new Uint8Array(t);const a=this.port.writable.getWriter();await a.write(o),await a.releaseLock()}}catch(a){console.error(a)}},async squatStart(){try{if(1==this.isLink){var e=this.initData[2],t=[];t[0]=255,t[1]=255,t[2]=50,t[3]=15;var r=65;for(let o=0;o<e.length;o++)t[4+o]=e[o],r+=e[o];r%=256,t[t.length]=r,console.log(t);var o=new Uint8Array(t);const a=this.port.writable.getWriter();await a.write(o),await a.releaseLock()}}catch(a){console.error(a)}},async actionDownload(e){try{const t=e.target.files[0],r=new FileReader;r.readAsText(t,"UTF-8"),r.onload=async e=>{const t=e.target.result,r=t.trim().split("\n").length;this.dataArr=[];for(let u=0;u<r;u++){const e=t.split("\r\n")[u].split(",")[0],r=e.split(/\s+/).map((e=>isNaN(e)?e:""==e?" ":Number(e)));this.dataArr.push(r)}if(1==this.isLink){var o=[],a=[],n=this.dataArr,l=n.length;for(let t=0;t<l;t++){var s=!1;" "==n[t][0]&&(s=!0),253==n[t][0]&&253==n[t][1]&&254==n[t][2]&&" "!=n[t][3]&&o.push(n[t][3]),1==s&&a.push(n[t])}var i=0;l=a.length;var c=[];for(let t=0;t<l;t++){var p=a[t][5],h=a[t][6],f=a[t][7],w=a[t][8],_=a[t][9],m=a[t][10];for(let o=0;o<8;o++){let e=p&Math.pow(2,7-o);0!=e&&(a[t][o+11]*=-1)}for(let o=0;o<8;o++){let e=h&Math.pow(2,7-o);0!=e&&(a[t][o+19]*=-1)}for(let o=0;o<8;o++){let e=f&Math.pow(2,7-o);0!=e&&(a[t][o+27]*=-1)}for(let o=0;o<8;o++){let e=w&Math.pow(2,7-o);0!=e&&(a[t][o+35]*=-1)}for(let o=0;o<8;o++){let e=_&Math.pow(2,7-o);0!=e&&(a[t][o+43]*=-1)}for(let o=0;o<8;o++){let e=m&Math.pow(2,7-o);0!=e&&(a[t][o+51]*=-1)}var d=0,g=!1,b=!1;0!=a[t][4]&&a[t][4]>128?d=a[t][4]-128:0!=a[t][4]&&a[t][4]<128?(d=a[t][4],g=!1,b=!0):0==a[t][4]&&(g=!1,b=!1);var v=[],y=a[t][3];for(let o=0;o<48;o++)v[o]=a[t][o+11];var k=a[t][59],P=a[t][60],L=0;let e=-1,r=-1;251!=a[t][61]&&251!=a[t][62]&&252!=a[t][61]&&252!=a[t][62]?(r=256*a[t][61]+a[t][62],L=2):251==a[t][61]&&251==a[t][62]?L=4:252==a[t][61]&&252==a[t][62]&&(L=3),e=r,0!=a[t][4]&&(g=0==i,a[t][4]<128?(b=!0,d=a[t][4]):(b=!1,d=a[t][4]-128)),i=a[t][4]>128?a[t][4]:0;var I={number:y,Name:1,Pos:v,Speed:k,Delay:P,Loop_Time:d,Is_Loop_Start:g,Is_Loop_End:b,Music_State:L,Music_Number:e};c.push(G(I))}l=c.length;let e=0;d=-1;var M=!1,F=[[]],S=c[0].number;F[0]=[];for(let t=0;t<l;t++){S!=c[t].number&&(S=c[t].number,e++,F[e]=[]);var x=[];x.push(255),x.push(255),x.push(61),x.push(2),M||(x[4]=0),!M||c[t].Is_Loop_Start||c[t].Is_Loop_End||(x[4]=d+128),c[t].Is_Loop_End&&(M=!1,x[4]=d,d=0),c[t].Is_Loop_Start&&(M=!0,d=c[t].Loop_Time,x[4]=d+128);var A=0,D=0,U=0,N=0,C=0,T=0;for(let e=0;e<48;e++)e<8&&c[t].Pos[e]<0&&(A+=parseInt(Math.pow(2,7-e)),c[t].Pos[e]=-1*c[t].Pos[e]),e>=8&&e<16&&c[t].Pos[e]<0&&(D+=parseInt(Math.pow(2,15-e)),c[t].Pos[e]=-1*c[t].Pos[e]),e>=16&&e<24&&c[t].Pos[e]<0&&(U+=parseInt(Math.pow(2,23-e)),c[t].Pos[e]=-1*c[t].Pos[e]),e>=24&&e<32&&c[t].Pos[e]<0&&(N+=parseInt(Math.pow(2,31-e)),c[t].Pos[e]=-1*c[t].Pos[e]),e>=32&&e<40&&c[t].Pos[e]<0&&(C+=parseInt(Math.pow(2,39-e)),c[t].Pos[e]=-1*c[t].Pos[e]),e>=40&&e<48&&c[t].Pos[e]<0&&(T+=parseInt(Math.pow(2,47-e)),c[t].Pos[e]=-1*c[t].Pos[e]);x[5]=A,x[6]=D,x[7]=U,x[8]=N,x[9]=C,x[10]=T;for(let e=0;e<48;e++)x[e+11]=c[t].Pos[e];switch(x[59]=c[t].Speed,x[60]=c[t].Delay,c[t].Music_State){case 1:x[61]=parseInt(c[t].Music_Number/256),x[62]=parseInt(c[t].Music_Number%256);break;case 2:x[61]=parseInt(c[t].Music_Number/256),x[62]=parseInt(c[t].Music_Number%256);break;case 3:x[61]=252,x[62]=252;break;case 4:x[61]=251,x[62]=251;break}var O=0;for(let e=2;e<63;e++)O+=x[e];O%=256,x[63]=O,F[e].push(x)}console.log(F),l=o.length;for(let t=0;t<l;t++){let e=new Promise(((e,t)=>{setTimeout((()=>e()),50)}));await e;var W=o[t];console.log(W);var B=W.substring(0,4),E=W.substring(4);"地面::"==B?B="GroundAction/":"凌空::"==B&&(B="VolleyAction/"),E=B+E;var R=Array.from(u().encode(E,"utf8")),q=R.length,V=q+2,j=[];j[0]=255,j[1]=255,j[2]=V,j[3]=21;O=V+21;for(let t=0;t<q;t++)j.push(R[t]),O+=R[t];O%=256,j.push(O);var H=new Uint8Array(j);const r=this.port.writable.getWriter();await r.write(H);const a=await this.port.readable.getReader();var Z=[],Y=!1;while(!Y){const{value:e,done:t}=await a.read();if(t){a.releaseLock();break}for(let r=0;r<e.length;r++)Z[Z.length]=e[r];for(let r=0;r<Z.length;r++)if(255==Z[r]&&255==Z[r+1]){var $=Z[r+3];21==$&&79==Z[r+4]&&75==Z[r+5]&&(Y=!0)}}let n=new Promise(((e,t)=>{setTimeout((()=>e()),50)}));await n,j[3]=20,j[j.length-1]=j[j.length-1]-1,H=new Uint8Array(j),await r.write(H),Z=[],Y=!1;while(!Y){const{value:e,done:t}=await a.read();if(t){a.releaseLock();break}for(let r=0;r<e.length;r++)Z[Z.length]=e[r];for(let r=0;r<Z.length;r++)if(255==Z[r]&&255==Z[r+1]){$=Z[r+3];20==$&&79==Z[r+4]&&75==Z[r+5]&&(Y=!0)}}let l=new Promise(((e,t)=>{setTimeout((()=>e()),50)}));await l,j=[],O=0,E+=".sh",console.log(E),R=Array.from(u().encode(E,"gb2312")),q=R.length,V=q+2,j[0]=255,j[1]=255,j[2]=V,j[3]=23,O=V+23;for(let t=0;t<q;t++)j.push(R[t]),O+=R[t];O%=256,j.push(O),H=new Uint8Array(j),await r.write(H),Z=[],Y=!1;while(!Y){const{value:e,done:t}=await a.read();if(t){a.releaseLock();break}for(let r=0;r<e.length;r++)Z[Z.length]=e[r];for(let r=0;r<Z.length;r++)if(255==Z[r]&&255==Z[r+1]){$=Z[r+3];23==$&&79==Z[r+4]&&75==Z[r+5]&&(Y=!0)}}let s=new Promise(((e,t)=>{setTimeout((()=>e()),50)}));await s,console.log(F[t]);for(let o=0;o<F[t].length;o++){let e=new Promise(((e,t)=>{setTimeout((()=>e()),150)}));await e;var z=new Uint8Array(F[t][o]);await r.write(z),Z=[],Y=!1;while(!Y){const{value:e,done:t}=await a.read();if(t){a.releaseLock();break}for(let r=0;r<e.length;r++)Z[Z.length]=e[r];for(let r=0;r<Z.length;r++)if(255==Z[r]&&255==Z[r+1]){$=Z[r+3];2==$&&79==Z[r+4]&&75==Z[r+5]&&(console.log(r+" "+Z),Y=!0)}}}await r.releaseLock(),await a.releaseLock()}}}}catch(t){console.error(t)}},async getActionName(){try{if(1==this.isLink){var e=Array.from(u().encode("GroundAction","gb2312")),t=e.length,r=t+2,o=[];o[0]=255,o[1]=255,o[2]=r,o[3]=26;var a=r+26;for(let r=0;r<t;r++)o.push(e[r]),a+=e[r];a%=256,o.push(a);var n=new Uint8Array(o);const f=this.port.writable.getWriter();await f.write(n);const w=await this.port.readable.getReader();var l=[],s=!1;while(!s){const{value:e,done:t}=await w.read();if(t){w.releaseLock();break}for(let r=0;r<e.length;r++)l[l.length]=e[r];for(let r=0;r<l.length;r++)if(255==l[r]&&255==l[r+1]&&4==l[r+2]&&250==l[r+3]&&79==l[r+4]&&75==l[r+5]&&152==l[r+6]){s=!0,l.slice(r,6);break}}var i=[];for(let e=0;e<l.length;e++)if(255==l[e]&&255==l[e+1]&&255!=l[e+2]&&26==l[e+3]){var c=l[e+2],p=[];for(let t=0;t<c-2;t++)p.push(l[e+4+t]);e=e+2+c;var h="地面::"+u().decode(p,"gb2312");i.push(h)}e=Array.from(u().encode("VolleyAction","gb2312")),t=e.length,r=t+2,o=[],o[0]=255,o[1]=255,o[2]=r,o[3]=26,a=r+26;for(let r=0;r<t;r++)o.push(e[r]),a+=e[r];a%=256,o.push(a),n=new Uint8Array(o),await f.write(n),l=[],s=!1;while(!s){const{value:e,done:t}=await w.read();if(t){w.releaseLock();break}for(let r=0;r<e.length;r++)l[l.length]=e[r];for(let r=0;r<l.length;r++)if(255==l[r]&&255==l[r+1]&&4==l[r+2]&&250==l[r+3]&&79==l[r+4]&&75==l[r+5]&&152==l[r+6]){s=!0,l.slice(r,6);break}}for(let e=0;e<l.length;e++)if(255==l[e]&&255==l[e+1]&&255!=l[e+2]&&26==l[e+3]){c=l[e+2],p=[];for(let t=0;t<c-2;t++)p.push(l[e+4+t]);e=e+2+c;h="凌空::"+u().decode(p,"gb2312");i.push(h)}await f.releaseLock(),await w.releaseLock(),this.vOpentions=i}}catch(f){console.error(f)}},async getAction(){try{if(1==this.isLink&&""!=this.selectedOption){var e=this.selectedOption.substring(0,4),t=this.selectedOption.substring(4);"地面::"==e?e="GroundAction/":"凌空::"==e&&(e="VolleyAction/"),t=e+t;var r=Array.from(u().encode(t,"gb2312")),o=r.length,a=o+3,n=[];n[0]=255,n[1]=255,n[2]=a,n[3]=22,n[4]=59;var l=a+22+59;for(let e=0;e<o;e++)n.push(r[e]),l+=r[e];l%=256,n.push(l);var s=new Uint8Array(n);const f=this.port.writable.getWriter();await f.write(s);const w=await this.port.readable.getReader();var i=[],c=!1;while(!c){const{value:e,done:t}=await w.read();if(t){w.releaseLock();break}for(let r=0;r<e.length;r++)i[i.length]=e[r];for(let r=0;r<i.length;r++)if(255==i[r]&&255==i[r+1]&&4==i[r+2]&&250==i[r+3]&&79==i[r+4]&&75==i[r+5]&&152==i[r+6]){c=!0,i.slice(r,6);break}}for(let e=0;e<i.length;e++)if(255==i[e]&&255==i[e+1]&&255!=i[e+2]&&22==i[e+3]){var p=i[e+2],h=[];for(let t=0;t<p-2;t++)h.push(i[e+4+t]);e=e+2+p,console.log(h)}await f.releaseLock(),await w.releaseLock()}}catch(f){console.error(f)}}}};const Z=(0,p.Z)(H,[["render",V]]);var Y=Z;const $=(0,o._)("h3",null,"大黄蜂机器人通讯结构",-1),z=(0,o._)("p",null,"连接方式 : 串口",-1),K=(0,o._)("p",null,"配置参数baudRate : 115200",-1),X=(0,o._)("p",null,"配置参数parity : 0",-1),J=(0,o._)("p",null,"配置参数dataBits : 8",-1),Q=(0,o._)("p",null,"配置参数stopBits : 1",-1),ee=(0,o._)("p",null,"配置参数bufferSize : 4096",-1),te=(0,o._)("label",null,[(0,o.Uk)(" 连接成功后，发送[0xFF, 0xFF, 0x02, 0xF5, 0xF7] 指令0xF5是进入PC编程模式 0xF7是(指令+数据)和%256的结果 "),(0,o._)("br"),(0,o.Uk)(" 发送后接收数据直到接收[0xFF,0xFF,0x04 0xF4,0x4F 0x4B,0x93] 当中的数据需要进行处理")],-1),re=(0,o._)("p",null,null,-1),oe=(0,o._)("p",null,null,-1),ae=(0,o._)("label",null,"下载是将pc上的数据载入到机器人当中，这里用一个.shr机器人保存再本地的文件开始,下载的指令顺序是:删除(0x07),创建(0X06),下载(0x02)",-1),ne=(0,o._)("p",null,null,-1);function le(e,t,r,a,n,l){const s=(0,o.up)("el-button");return(0,o.wg)(),(0,o.iD)(o.HY,null,[$,z,K,X,J,Q,ee,(0,o.Wm)(s,{type:"primary",onClick:t[0]||(t[0]=e=>l.requestSerialPort())},{default:(0,o.w5)((()=>[(0,o.Uk)("连接")])),_:1}),te,re,(0,o._)("input",{type:"file",onChange:t[1]||(t[1]=(...e)=>l.actionDownload&&l.actionDownload(...e))},null,32),oe,ae,ne],64)}var se={data(){return{port:{},isLink:!1,initData:[],dataArr:[]}},methods:{async requestSerialPort(){try{const a=await navigator.serial.requestPort();if(null!=a){await a.open({baudRate:115200,dataBits:8,stopBits:1,bufferSize:4096}),this.port=a;const n=new Uint8Array([255,255,2,245,247]),l=a.writable.getWriter();await l.write(n),await l.releaseLock();const s=await a.readable.getReader();this.isLink=!1;var e=[];while(1){if(1==this.isLink){s.releaseLock();break}const{value:o,done:a}=await s.read();if(a){s.releaseLock();break}for(let t=0;t<o.length;t++)e[e.length]=o[t];for(let n=0;n<e.length;n++)if(255==e[n]&&255==e[n+1]){var t=e[n+2],r=e[n+3];if(4==t&&245==r&&79==e[n+4]&&75==e[n+5]&&e[n+6]==(t+r+79+75)%256){this.isLink=!0;break}}}let i=0;for(let a=0;a<e.length;a++)if(255==e[a]&&255==e[a+1]){t=e[a+2],r=e[a+3];if(50==t&&245==r){var o=[];for(let t=0;t<48;t++)o[t]=e[a+t+4];a+=52,this.initData[i]=o,i++}}console.log(this.initData)}}catch(a){console.error(a)}},async actionDownload(e){try{const t=e.target.files[0],r=new FileReader;r.readAsText(t,"UTF-8"),r.onload=async e=>{const t=e.target.result,r=t.trim().split("\n").length;this.dataArr=[];for(let u=0;u<r;u++){const e=t.split("\r\n")[u].split(",")[0],r=e.split(/\s+/).map((e=>isNaN(e)?e:""==e?" ":Number(e)));this.dataArr.push(r)}if(1==this.isLink){var o=[],a=[],n=this.dataArr,l=n.length;for(let t=0;t<l;t++){var s=!1;" "==n[t][0]&&(s=!0),253==n[t][0]&&253==n[t][1]&&254==n[t][2]&&" "!=n[t][3]&&o.push(n[t][3]),1==s&&a.push(n[t])}var i=0;l=a.length;var c=[];console.log(a);for(let t=0;t<l;t++){var p=a[t][5],h=a[t][6],f=a[t][7],w=a[t][8],_=a[t][9],m=a[t][10];for(let e=0;e<8;e++){let r=p&Math.pow(2,7-e);0!=r&&(a[t][e+11]*=-1)}for(let e=0;e<8;e++){let r=h&Math.pow(2,7-e);0!=r&&(a[t][e+19]*=-1)}for(let e=0;e<8;e++){let r=f&Math.pow(2,7-e);0!=r&&(a[t][e+27]*=-1)}for(let e=0;e<8;e++){let r=w&Math.pow(2,7-e);0!=r&&(a[t][e+35]*=-1)}for(let e=0;e<8;e++){let r=_&Math.pow(2,7-e);0!=r&&(a[t][e+43]*=-1)}for(let e=0;e<8;e++){let r=m&Math.pow(2,7-e);0!=r&&(a[t][51]*=-1)}var d=0,g=!1,b=!1;0!=a[t][4]&&a[t][4]>128?d=a[t][4]-128:0!=a[t][4]&&a[t][4]>128?(d=a[t][4],g=!1,b=!0):0==a[t][4]&&(g=!1,b=!1);var v=[],y=a[t][3];for(let e=0;e<48;e++)v[e]=a[t][e+11];var k=a[t][59],P=a[t][60],L=0,I=-1,M=-1;251!=a[t][61]&&251!=a[t][62]&&252!=a[t][61]&&252!=a[t][62]?(M=256*a[t][61]+a[t][62],L=2):251==a[t][61]&&251==a[t][62]?L=4:252==a[t][61]&&252==a[t][62]&&(L=3),I=M,0!=a[t][4]&&(g=0==i,a[t][4]<128?(b=!0,d=a[t][4]):(b=!1,d=a[t][4]-128)),i=a[t][4]>128?a[t][4]:0;var F={number:y,Name:1,Pos:v,Speed:k,Delay:P,Loop_Time:d,Is_Loop_Start:g,Is_Loop_End:b,Music_State:L,Music_Number:I};c.push(G(F))}if(console.log(c),0==this.isLink)return;l=c.length;let e=0;d=-1;var S=!1,x=[[]],A=c[0].number;x[0]=[];for(let t=0;t<l;t++){A!=c[t].number&&(A=c[t].number,e++,x[e]=[]);var D=[];D.push(255),D.push(255),D.push(61),D.push(2),S||(D[4]=0),!S||c[t].Is_Loop_Start||c[t].Is_Loop_End||(D[4]=d+128),c[t].Is_Loop_End&&(S=!1,D[4]=d,d=0),c[t].Is_Loop_Start&&(S=!0,d=c[t].Loop_Time,D[4]=d+128);var U=0,N=0,C=0,T=0,O=0,W=0;for(let e=0;e<48;e++)e<8&&c[t].Pos[e]<0&&(U+=parseInt(Math.pow(2,7-e)),c[t].Pos[e]=-1*c[t].Pos[e]),e>=8&&e<16&&c[t].Pos[e]<0&&(N+=parseInt(Math.pow(2,15-e)),c[t].Pos[e]=-1*c[t].pos[e]),e>=16&&e<24&&c[t].Pos[e]<0&&(C+=parseInt(Math.pow(2,23-e)),c[t].Pos[e]=-1*c[t].Pos[e]),e>=24&&e<32&&c[t].Pos[e]<0&&(T+=parseInt(Math.pow(2,31-e)),c[t].Pos[e]=-1*c[t].Pos[e]),e>=32&&e<40&&c[t].Pos[e]<0&&(O+=parseInt(Math.pow(2,39-e)),c[t].Pos[e]=-1*c[t].Pos[e]),e>=40&&e<48&&c[t].Pos[e]<0&&(W+=parseInt(Math.pow(2,47-e)),c[t].Pos[e]=-1*c[t].Pos[e]);D[5]=U,D[6]=N,D[7]=C,D[8]=T,D[9]=O,D[10]=W;for(let e=0;e<48;e++)D[e+11]=c[t].Pos[e];switch(D[59]=c[t].Speed,D[60]=c[t].Delay,c[t].Music_State){case 1:D[61]=parseInt(c[t].Music_Number/256),D[62]=parseInt(c[t].Music_Number%256);break;case 2:D[61]=parseInt(c[t].Music_Number/256),D[62]=parseInt(c[t].Music_Number%256);break;case 3:D[61]=252,D[62]=252;break;case 4:D[61]=251,D[62]=251;break}var B=0;for(let e=2;e<63;e++)B+=D[e];B%=256,D[63]=B,x[e].push(D)}l=o.length,console.log(x);for(let t=0;t<l;t++){let e=new Promise(((e,t)=>{setTimeout((()=>e()),50)}));await e;var E=o[t],R=Array.from(u().encode(E,"utf8")),q=R.length,V=q+2,j=[];B=0;j[0]=255,j[1]=255,j[2]=V,j[3]=7,B=V+7;for(let t=0;t<q;t++)j.push(R[t]),B+=R[t];B%=256,j.push(B);var H=new Uint8Array(j);const r=this.port.writable.getWriter();await r.write(H);const a=await this.port.readable.getReader();let n=new Promise(((e,t)=>{setTimeout((()=>e()),50)}));await n,j[3]=6,j[j.length-1]=j[j.length-1]-1,H=new Uint8Array(j),await r.write(H),[],!1;let l=new Promise(((e,t)=>{setTimeout((()=>e()),50)}));await l;for(let o=0;o<x[t].length;o++){let e=new Promise(((e,t)=>{setTimeout((()=>e()),50)}));await e;const a=new Uint8Array(x[t][o]);console.log(a),await r.write(a),[],!1}await r.releaseLock(),await a.releaseLock()}console.log("上传完成")}}}catch(t){}}}};const ie=(0,p.Z)(se,[["render",le]]);var ue=ie;const ce=(0,o._)("h3",null,"钢索机器人通讯结构",-1),pe=(0,o._)("p",null,"连接方式 ： HID(usb口的一种方式)",-1),he=(0,o._)("p",null,"匹配VendorID ： 0x0483",-1),fe=(0,o._)("p",null,"匹配ProductID ： 0x5750",-1),we=(0,o._)("label",null,"连接成功后发送[0xFF, 0x02, 0xF5, 0xF7]读取数据直到获取到[4F 4B](OK)后接收结束",-1),_e=(0,o._)("p",null,null,-1),me=(0,o._)("label",null,"关闭需要发送指令 [ 0xFF, 0x02, 0xF6, 0xF8] 然后断开HID",-1),de=(0,o._)("p",null,null,-1);function ge(e,t,r,a,n,l){const s=(0,o.up)("el-button");return(0,o.wg)(),(0,o.iD)(o.HY,null,[ce,pe,he,fe,(0,o.Wm)(s,{type:"primary",onClick:t[0]||(t[0]=e=>l.requestSerialPort())},{default:(0,o.w5)((()=>[(0,o.Uk)("连接")])),_:1}),we,_e,(0,o.Wm)(s,{type:"primary",onClick:t[1]||(t[1]=e=>l.closeMessage())},{default:(0,o.w5)((()=>[(0,o.Uk)("关闭")])),_:1}),me,de,(0,o._)("input",{type:"file",onChange:t[2]||(t[2]=(...e)=>l.actionDownload&&l.actionDownload(...e))},null,32),(0,o.Uk)(" 下载功能 ")],64)}class be{constructor({number:e,Name:t,Pos:r,Speed:o,Delay:a,Loop_Time:n,Is_Loop_Start:l,Is_Loop_End:s,Music_State:i,Music_Number:u,Is_Cur_Form:c}){this.number=e,this.Name=t,this.Pos=r,this.Speed=o,this.Delay=a,this.Loop_Time=n,this.Is_Loop_Start=l,this.Is_Loop_End=s,this.Music_State=i,this.Music_Number=u,this.Is_Cur_Form=c}}function ve(e){return new be({number:e.number,Name:e.Name,Pos:e.Pos,Speed:e.Speed,Delay:e.Delay,Loop_Time:e.Loop_Time,Is_Loop_Start:e.Is_Loop_Start,Is_Loop_End:e.Is_Loop_End,Music_State:e.Music_State,Music_Number:e.Music_Number,Is_Cur_Form:e.Is_Cur_Form})}var ye={data(){return{initData:[],isInitData:!1,endpointNumber:2,isLink:!1,hidDevice:[],dataArr:[]}},methods:{async requestSerialPort(){try{await navigator.hid.requestDevice({filters:[{vendorId:1155,productId:22352}]}).then((async e=>{await e[0].open(),this.hidDevice=e[0],e[0].addEventListener("inputreport",this.receivingProcess),this.initData=[],this.isInitData=!1;var t=new Uint8Array([255,2,245,247]);await e[0].sendReport(0,t)})).catch((e=>{console.error(e)}))}catch(e){console.log(e)}},async closeMessage(){if(1==this.isLink){var e=new Uint8Array([255,2,246,248]);await this.hidDevice.sendReport(0,e)}},async actionDownload(e){var t=e.target.files[0],r=new FileReader;r.readAsText(t,"UTF-8"),r.onload=async e=>{const t=e.target.result,r=t.trim().split("\n").length;this.dataArr=[];for(let u=0;u<r;u++){const e=t.split("\r\n")[u].split(",")[0],r=e.split(/\s+/).map((e=>isNaN(e)?e:""==e?" ":Number(e)));this.dataArr.push(r)}{var o=[],a=[],n=this.dataArr,l=n.length;for(let t=0;t<l;t++){var s=!1;" "==n[t][0]&&(s=!0),253==n[t][0]&&253==n[t][1]&&254==n[t][2]&&" "!=n[t][3]&&o.push(n[t][3]),1==s&&a.push(n[t])}var i=0;l=a.length;var c=[];for(let t=0;t<l;t++){var p=a[t][5],h=a[t][6],f=a[t][7],w=a[t][8],_=a[t][9],m=a[t][10];for(let e=0;e<8;e++){let r=p&Math.pow(2,7-e);0!=r&&(a[t][e+11]*=-1)}for(let e=0;e<8;e++){let r=h&Math.pow(2,7-e);0!=r&&(a[t][e+19]*=-1)}for(let e=0;e<8;e++){let r=f&Math.pow(2,7-e);0!=r&&(a[t][e+27]*=-1)}for(let e=0;e<8;e++){let r=w&Math.pow(2,7-e);0!=r&&(a[t][e+35]*=-1)}for(let e=0;e<8;e++){let r=_&Math.pow(2,7-e);0!=r&&(a[t][e+43]*=-1)}for(let e=0;e<8;e++){let r=m&Math.pow(2,7-e);0!=r&&(a[t][e+51]*=-1)}var d=0,g=!1,b=!1;0!=a[t][4]&&a[t][4]>128?d=a[t][4]-128:0!=a[t][4]&&a[t][4]<128?(d=a[t][4],g=!1,b=!0):0==a[t][4]&&(g=!1,b=!1);var v=[],y=a[t][3];for(let e=0;e<48;e++)v[e]=a[t][e+11];var k=a[t][59],P=a[t][60],L=0,I=-1,M=-1,F=0,S=a[t].length-2;63==S?(251!=a[t][61]&&251!=a[t][62]&&252!=a[t][61]&&252!=a[t][62]?(M=256*a[t][61]+a[t][62],L=2):251==a[t][61]&&251==a[t][62]?L=4:252==a[t][61]&&252==a[t][62]&&(L=3),I=M):61==S&&(M=0,L=2),F=a[t][a[t].length-2],I=M,0!=a[t][4]&&(g=0==i,a[t][4]<128?(b=!0,d=a[t][4]):(b=!1,d=a[t][4]-128)),i=a[t][4]>128?a[t][4]:0;var x={number:y,Name:1,Pos:v,Speed:k,Delay:P,Loop_Time:d,Is_Loop_Start:g,Is_Loop_End:b,Music_State:L,Music_Number:I,Is_Cur_Form:F};c.push(ve(x))}l=c.length;let e=0;d=-1;var A=!1,D=[[]],U=c[0].number;D[0]=[];for(let t=0;t<l;t++){U!=c[t].number&&(U=c[t].number,e++,D[e]=[]);var N=[];N.push(255),N.push(61),N.push(2),A||(N[3]=0),!A||c[t].Is_Loop_Start||c[t].Is_Loop_End||(N[3]=d+128),c[t].Is_Loop_End&&(A=!1,N[3]=d,d=0),c[t].Is_Loop_Start&&(A=!0,d=c[t].Loop_Time,N[3]=d+128);var C=0,T=0,O=0,W=0,B=0,E=0;for(let e=0;e<48;e++)e<8&&c[t].Pos[e]<0&&(C+=parseInt(Math.pow(2,7-e)),c[t].Pos[e]=-1*c[t].Pos[e]),e>=8&&e<16&&c[t].Pos[e]<0&&(T+=parseInt(Math.pow(2,15-e)),c[t].Pos[e]=-1*c[t].Pos[e]),e>=16&&e<24&&c[t].Pos[e]<0&&(O+=parseInt(Math.pow(2,23-e)),c[t].Pos[e]=-1*c[t].Pos[e]),e>=24&&e<32&&c[t].Pos[e]<0&&(W+=parseInt(Math.pow(2,31-e)),c[t].Pos[e]=-1*c[t].Pos[e]),e>=32&&e<40&&c[t].Pos[e]<0&&(B+=parseInt(Math.pow(2,39-e)),c[t].Pos[e]=-1*c[t].Pos[e]),e>=40&&e<48&&c[t].Pos[e]<0&&(E+=parseInt(Math.pow(2,47-e)),c[t].Pos[e]=-1*c[t].Pos[e]);N[4]=C,N[5]=T,N[6]=O,N[7]=W,N[8]=B,N[9]=E;for(let e=0;e<48;e++)N[e+11]=c[t].Pos[e];switch(N[58]=c[t].Speed,N[59]=c[t].Delay,c[t].Music_State){case 1:N[60]=parseInt(c[t].Music_Number/256),N[61]=parseInt(c[t].Music_Number%256);break;case 2:N[60]=parseInt(c[t].Music_Number/256),N[61]=parseInt(c[t].Music_Number%256);break;case 3:N[60]=252,N[61]=252;break;case 4:N[60]=251,N[61]=251;break}N[62]=c[t].Is_Cur_Form;var R=0,q=N.length;for(let e=2;e<q;e++)R+=N[e];R%=256,N[63]=R,D[e].push(N)}l=o.length;for(let t=0;t<l;t++){let e=new Promise(((e,t)=>{setTimeout((()=>e()),50)}));await e;var V=o[t],j=V.substring(0,3),G=V.substring(3);"人型:"==j?j="RobotAction/":"龙型:"==j&&(j="Action/"),G=j+G,console.log(G);var H=Array.from(u().encode(G,"utf8")),Z=H.length,Y=Z+2,$=[];$[0]=255,$[1]=Y,$[2]=21;R=Y+21;for(let t=0;t<Z;t++)$.push(H[t]),R+=H[t];R%=256,$.push(R);var z=new Uint8Array($);await this.hidDevice.sendReport(0,z),console.log(z);let r=new Promise(((e,t)=>{setTimeout((()=>e()),50)}));await r}}}},async receivingProcess(e){try{const{data:n}=e,l=new Uint8Array(n.buffer);console.log(l);var t=l.length;for(let e=0;e<t;e++)if(255==l[e]&&255==l[e+1]){var r=l[e+2],o=l[e+3];if(50==r&&245==o){var a=[];for(let t=0;t<48;t++)a[t]=l[e+t+4];this.initData.push(a)}else 4==r&&245==o&&79==l[e+4]&&75==l[e+5]?(this.isLink=!0,this.isInitData=!0,console.log("isInitData = "+this.isInitData)):4==r&&246==o&&79==l[e+4]&&75==l[e+5]&&(this.isLink=!1,this.hidDevice.close())}}catch(n){console.log(n)}}}};const ke=(0,p.Z)(ye,[["render",ge]]);var Pe=ke,Le={__name:"Bluetooth",setup(e){let t,r;async function a(e,t,r,o){try{const e=await service.getCharacteristic("0xffc1");console.log(e),await e.writeValue(o),console.log("数据发送成功")}catch(a){console.error("发送数据出错:",a)}}async function n(){try{const e={filters:[{namePrefix:"BUZZ"}],optionalServices:[65472]};t=await navigator.bluetooth.requestDevice(e),r=await t.gatt.connect(),await new Promise((e=>setTimeout(e,1e3)));const o=await r.getPrimaryServices(65472);console.log(o);const a=await o[0].getCharacteristic(65473);console.log(a),a.startNotifications(),a.addEventListener("characteristicvaluechanged",(e=>{console.log(e.target.value)})),await a.writeValue(new Uint8Array([85,170,0,5,19,231,95,93,186]))}catch(e){console.error("连接设备出错:",e)}}async function l(){console.log(r);const e=await r.getPrimaryServices("battery_service");console.log(e)}return(e,t)=>{const r=(0,o.up)("el-button");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(r,{onClick:n},{default:(0,o.w5)((()=>[(0,o.Uk)("连接蓝牙设备")])),_:1}),(0,o.Wm)(r,{type:"primary",onClick:l},{default:(0,o.w5)((()=>[(0,o.Uk)("获取UUID")])),_:1}),(0,o.Wm)(r,{type:"success",onClick:a},{default:(0,o.w5)((()=>[(0,o.Uk)("发送数据")])),_:1})],64)}}};const Ie=Le;var Me=Ie;const Fe=(0,a.p7)({mode:"hash",history:(0,a.r5)(),routes:[{path:"/",name:"HomePage",component:f},{path:"/Convoy_Seven",name:"Convoy_Seven",component:Y},{path:"/Bumblebee",name:"Bumblebee",component:ue},{path:"/SteelCable",name:"SteelCable",component:Pe},{path:"/Bluetooth",name:"Bluetooth",component:Me}]});var Se=Fe,xe=r(2219);r(4415);const Ae={id:"app"};function De(e,t){const r=(0,o.up)("router-view");return(0,o.wg)(),(0,o.iD)("div",Ae,[(0,o.Wm)(r)])}const Ue={},Ne=(0,p.Z)(Ue,[["render",De]]);var Ce=Ne;const Te=(0,o.ri)(Ce);Te.use(Se),Te.use(xe.Z),Te.mount("#app")},5832:function(){}},t={};function r(o){var a=t[o];if(void 0!==a)return a.exports;var n=t[o]={exports:{}};return e[o].call(n.exports,n,n.exports,r),n.exports}r.m=e,function(){var e=[];r.O=function(t,o,a,n){if(!o){var l=1/0;for(c=0;c<e.length;c++){o=e[c][0],a=e[c][1],n=e[c][2];for(var s=!0,i=0;i<o.length;i++)(!1&n||l>=n)&&Object.keys(r.O).every((function(e){return r.O[e](o[i])}))?o.splice(i--,1):(s=!1,n<l&&(l=n));if(s){e.splice(c--,1);var u=a();void 0!==u&&(t=u)}}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[o,a,n]}}(),function(){r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,{a:t}),t}}(),function(){r.d=function(e,t){for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};r.O.j=function(t){return 0===e[t]};var t=function(t,o){var a,n,l=o[0],s=o[1],i=o[2],u=0;if(l.some((function(t){return 0!==e[t]}))){for(a in s)r.o(s,a)&&(r.m[a]=s[a]);if(i)var c=i(r)}for(t&&t(o);u<l.length;u++)n=l[u],r.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return r.O(c)},o=self["webpackChunkrobot_comm_model"]=self["webpackChunkrobot_comm_model"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=r.O(void 0,[998],(function(){return r(4787)}));o=r.O(o)})();
//# sourceMappingURL=app.a3b5c79f.js.map