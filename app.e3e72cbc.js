(function(){var e={6514:function(e,t,r){"use strict";var a=r(8222),o=r(2201);const n=(0,a._)("h3",null,"机器人通信Dome(通信方式不要按照我这种来，最好采用通讯池的方式，接收和发送都在通讯池中处理)",-1),l=(0,a._)("p",null,"通讯格式为:帧头、数据长度、指令、数据、校验位 ",-1);function i(e,t,r,o,i,s){const u=(0,a.up)("el-button");return(0,a.wg)(),(0,a.iD)("div",null,[n,l,(0,a.Wm)(u,{type:"primary",onClick:t[0]||(t[0]=e=>s.GO_Convoy_Seven())},{default:(0,a.w5)((()=>[(0,a.Uk)("变七")])),_:1}),(0,a.Wm)(u,{type:"primary",onClick:t[1]||(t[1]=e=>s.GO_Bumblebee())},{default:(0,a.w5)((()=>[(0,a.Uk)("大黄蜂")])),_:1}),(0,a.Wm)(u,{type:"primary",onClick:t[2]||(t[2]=e=>s.GO_SteelCable())},{default:(0,a.w5)((()=>[(0,a.Uk)("钢索")])),_:1})])}var s=r(4914),u=r.n(s),c={data(){return{msg:"aaa",ports:[]}},methods:{async requestSerialPort(){try{const e=await navigator.serial.requestPort();console.log(e)}catch(e){console.error(e)}},async getSerialPorts(){try{this.ports=await navigator.serial.getPorts(),console.log(this.ports)}catch(e){console.error(e)}},GO_Convoy_Seven(){this.$router.replace("/Convoy_Seven")},GO_Bumblebee(){this.$router.replace("/Bumblebee")},GO_SteelCable(){this.$router.replace("/SteelCable")},async f(){var e=[0,1,2,3,4,9,6,7,8,10];for(let a=0;a<e.length;a++)if(5==a){e.splice(a,5);break}var t=Array.from(u().encode("VolleyAction/1","utf8")),r=Array.from(u().encode("VolleyAction/1","gb2312"));console.log(t),console.log(r)}},mounted(){}},p=r(3744);const h=(0,p.Z)(c,[["render",i]]);var f=h;const w=(0,a._)("h3",null,"变七机器人通讯结构",-1),d=(0,a._)("p",null,"连接方式 : 串口",-1),m=(0,a._)("p",null,"配置参数baudRate : 115200",-1),_=(0,a._)("p",null,"配置参数parity : 0",-1),g=(0,a._)("p",null,"配置参数dataBits : 8",-1),b=(0,a._)("p",null,"配置参数stopBits : 1",-1),v=(0,a._)("label",null,[(0,a.Uk)(" 连接成功后，发送[0xFF, 0xFF, 0x02, 0xF5, 0xF7] 指令0xF5是进入PC编程模式 0xF7是(指令+数据)和%256的结果 "),(0,a._)("br"),(0,a.Uk)(" 发送后接收数据直到接收[0xFF,0xFF,0x04 0xF4,0x4F 0x4B,0x93] 当中的数据需要进行处理")],-1),y=(0,a._)("p",null,null,-1),k=(0,a._)("label",null,"关闭需要发送指令 [0xFF, 0xFF, 0x02, 0xF6, 0xF8] 然后断开端口",-1),P=(0,a._)("p",null,null,-1),L=(0,a._)("label",null,"例如:左肩旋转: ",-1),x=(0,a._)("label",null,"控制舵机移动[0xFF,0xFF,数据长度,指令(0x01),数据(位置+速度),sum和]指定左肩的下标控制",-1),F=(0,a._)("p",null,null,-1),A=(0,a._)("label",null,"初始位置在人形的时候就已经读取过，具体是那个看代码，保存指令为[0xFF,0xFF,数据长度,指令(0x03) 数据,sum和] 更改方式也是指定的某个轴的下标",-1),S=(0,a._)("p",null,null,-1),M=(0,a._)("label",null,"初始位置在人形的时候就已经读取过，具体是那个看代码，保存指令为[0xFF,0xFF,数据长度,指令(0x0F) 数据,sum和] 更改方式也是指定的某个轴的下标",-1),I=(0,a._)("p",null,null,-1),U=(0,a._)("p",null,null,-1),O=(0,a._)("label",null,"下载是将pc上的数据载入到机器人当中，这里用一个.shr机器人保存再本地的文件开始,下载的指令顺序是:删除(0x15),创建(0x14),修改(0x17),下载(0x02)",-1),C=(0,a._)("p",null,null,-1),D=(0,a._)("label",null,"这个地方有个bug就是文件名是数字且这个数字小于10的情况下发送到机器人的数据会多一个具体原因不明(感觉是机器人内部处理的问题，用纯PC的软件不会)",-1),N=(0,a._)("p",null,null,-1),T=(0,a._)("h4",null,"上传功能",-1),W=(0,a._)("label",null,"上传功能首先需要读取一下机器人内部的上传动作文件名",-1),B=(0,a._)("p",null,null,-1),R=(0,a._)("label",null,"以绝对路径读取文件夹指令为[0xFF,0xFF,数据长度,指令(0x1A) 数据,sum和]",-1),E=(0,a._)("p",null,null,-1),V=(0,a._)("label",null,"上传，先选择要上传的文件，然后发送指令[0xFF,0xFF,数据长度,指令(0x16),0x3B,(固定数据) 数据(文件名称数据),sum和]",-1);function q(e,t,r,o,n,l){const i=(0,a.up)("el-button"),s=(0,a.up)("el-input"),u=(0,a.up)("el-option"),c=(0,a.up)("el-select");return(0,a.wg)(),(0,a.iD)(a.HY,null,[w,d,m,_,g,b,(0,a.Wm)(i,{type:"primary",onClick:t[0]||(t[0]=e=>l.requestSerialPort())},{default:(0,a.w5)((()=>[(0,a.Uk)("连接")])),_:1}),v,y,(0,a.Wm)(i,{type:"primary",onClick:t[1]||(t[1]=e=>l.closePose())},{default:(0,a.w5)((()=>[(0,a.Uk)("关闭")])),_:1}),k,P,(0,a.Wm)(i,{type:"primary",onClick:t[2]||(t[2]=e=>l.timeSendingPosition())},{default:(0,a.w5)((()=>[(0,a.Uk)("时时发送位置")])),_:1}),L,(0,a.Wm)(s,{modelValue:n.ArmInput,"onUpdate:modelValue":t[3]||(t[3]=e=>n.ArmInput=e),style:{width:"50px"}},null,8,["modelValue"]),x,F,(0,a.Wm)(i,{type:"primary",onClick:t[4]||(t[4]=e=>l.humanoidInitial())},{default:(0,a.w5)((()=>[(0,a.Uk)("人形初始位置保存")])),_:1}),A,S,(0,a.Wm)(i,{type:"primary",onClick:t[5]||(t[5]=e=>l.squatStart())},{default:(0,a.w5)((()=>[(0,a.Uk)("下蹲初始位置")])),_:1}),M,I,(0,a._)("input",{type:"file",onChange:t[6]||(t[6]=(...e)=>l.actionDownload&&l.actionDownload(...e))},null,32),(0,a.Uk)(" 下载功能 "),U,O,C,D,N,T,W,B,(0,a.Wm)(i,{type:"primary",onClick:t[7]||(t[7]=e=>l.getActionName())},{default:(0,a.w5)((()=>[(0,a.Uk)("读取")])),_:1}),(0,a.Wm)(c,{modelValue:n.selectedOption,"onUpdate:modelValue":t[8]||(t[8]=e=>n.selectedOption=e)},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.vOpentions,(e=>((0,a.wg)(),(0,a.j4)(u,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),R,E,(0,a.Wm)(i,{type:"primary",onClick:t[9]||(t[9]=e=>l.getAction())},{default:(0,a.w5)((()=>[(0,a.Uk)(" 上传")])),_:1}),V],64)}r(1439),r(7585),r(5315),r(7658);class j{constructor({number:e,Name:t,Pos:r,Speed:a,Delay:o,Loop_Time:n,Is_Loop_Start:l,Is_Loop_End:i,Music_State:s,Music_Number:u}){this.number=e,this.Name=t,this.Pos=r,this.Speed=a,this.Delay=o,this.Loop_Time=n,this.Is_Loop_Start=l,this.Is_Loop_End=i,this.Music_State=s,this.Music_Number=u}}function G(e){return new j({number:e.number,Name:e.Name,Pos:e.Pos,Speed:e.Speed,Delay:e.Delay,Loop_Time:e.Loop_Time,Is_Loop_Start:e.Is_Loop_Start,Is_Loop_End:e.Is_Loop_End,Music_State:e.Music_State,Music_Number:e.Music_Number})}var Z={data(){return{port:{},isLink:!1,initData:[],ArmInput:0,dataArr:[],selectedOption:"",vOpentions:[]}},methods:{async requestSerialPort(){try{const o=await navigator.serial.requestPort();if(null!=o){await o.open({baudRate:115200,parity:"none",dataBits:8,stopBits:1}),this.port=o;const n=new Uint8Array([255,255,2,245,247]),l=o.writable.getWriter();await l.write(n),await l.releaseLock();const i=await o.readable.getReader();this.isLink=!1;var e=[];while(1){if(1==this.isLink){i.releaseLock();break}const{value:a,done:o}=await i.read();if(o){i.releaseLock();break}for(let t=0;t<a.length;t++)e[e.length]=a[t];for(let n=0;n<e.length;n++)if(255==e[n]&&255==e[n+1]){var t=e[n+2],r=e[n+3];if(4==t&&245==r&&79==e[n+4]&&75==e[n+5]&&e[n+6]==(t+r+79+75)%256){this.isLink=!0;break}}}let s=0;for(let o=0;o<e.length;o++)if(255==e[o]&&255==e[o+1]){t=e[o+2],r=e[o+3];if(50==t&&245==r){var a=[];for(let t=0;t<48;t++)a[t]=e[o+t+4];o+=52,this.initData[s]=a,s++}}}}catch(o){console.error(o)}},async closePose(){try{const e=new Uint8Array([255,255,2,246,248]),t=this.port.writable.getWriter();await t.write(e),this.isLink=!1}catch(e){console.error(e)}},async timeSendingPosition(){try{if(1==this.isLink){var e=this.initData[0];e[12]+=parseInt(this.ArmInput),e[e.length]=25;var t=[];t[0]=255,t[1]=255,t[2]=51,t[3]=1;var r=52;for(let a=0;a<e.length;a++)t[4+a]=e[a],r+=e[a];r%=256,t[t.length]=r;var a=new Uint8Array(t);const o=this.port.writable.getWriter();await o.write(a),await o.releaseLock()}}catch(o){console.error(o)}},async humanoidInitial(){try{if(1==this.isLink){var e=this.initData[0],t=[];t[0]=255,t[1]=255,t[2]=50,t[3]=3;var r=53;for(let a=0;a<e.length;a++)t[4+a]=e[a],r+=e[a];r%=256,t[t.length]=r,console.log(t);var a=new Uint8Array(t);const o=this.port.writable.getWriter();await o.write(a),await o.releaseLock()}}catch(o){console.error(o)}},async squatStart(){try{if(1==this.isLink){var e=this.initData[2],t=[];t[0]=255,t[1]=255,t[2]=50,t[3]=15;var r=65;for(let a=0;a<e.length;a++)t[4+a]=e[a],r+=e[a];r%=256,t[t.length]=r,console.log(t);var a=new Uint8Array(t);const o=this.port.writable.getWriter();await o.write(a),await o.releaseLock()}}catch(o){console.error(o)}},async actionDownload(e){try{const t=e.target.files[0],r=new FileReader;r.readAsText(t,"UTF-8"),r.onload=async e=>{const t=e.target.result,r=t.trim().split("\n").length;this.dataArr=[];for(let u=0;u<r;u++){const e=t.split("\r\n")[u].split(",")[0],r=e.split(/\s+/).map((e=>isNaN(e)?e:""==e?" ":Number(e)));this.dataArr.push(r)}if(1==this.isLink){var a=[],o=[],n=this.dataArr,l=n.length;for(let t=0;t<l;t++){var i=!1;" "==n[t][0]&&(i=!0),253==n[t][0]&&253==n[t][1]&&254==n[t][2]&&" "!=n[t][3]&&a.push(n[t][3]),1==i&&o.push(n[t])}var s=0;l=o.length;var c=[];for(let t=0;t<l;t++){var p=o[t][5],h=o[t][6],f=o[t][7],w=o[t][8],d=o[t][9],m=o[t][10];for(let a=0;a<8;a++){let e=p&Math.pow(2,7-a);0!=e&&(o[t][a+11]*=-1)}for(let a=0;a<8;a++){let e=h&Math.pow(2,7-a);0!=e&&(o[t][a+19]*=-1)}for(let a=0;a<8;a++){let e=f&Math.pow(2,7-a);0!=e&&(o[t][a+27]*=-1)}for(let a=0;a<8;a++){let e=w&Math.pow(2,7-a);0!=e&&(o[t][a+35]*=-1)}for(let a=0;a<8;a++){let e=d&Math.pow(2,7-a);0!=e&&(o[t][a+43]*=-1)}for(let a=0;a<8;a++){let e=m&Math.pow(2,7-a);0!=e&&(o[t][a+51]*=-1)}var _=0,g=!1,b=!1;0!=o[t][4]&&o[t][4]>128?_=o[t][4]-128:0!=o[t][4]&&o[t][4]<128?(_=o[t][4],g=!1,b=!0):0==o[t][4]&&(g=!1,b=!1);var v=[],y=o[t][3];for(let a=0;a<48;a++)v[a]=o[t][a+11];var k=o[t][59],P=o[t][60],L=0;let e=-1,r=-1;251!=o[t][61]&&251!=o[t][62]&&252!=o[t][61]&&252!=o[t][62]?(r=256*o[t][61]+o[t][62],L=2):251==o[t][61]&&251==o[t][62]?L=4:252==o[t][61]&&252==o[t][62]&&(L=3),e=r,0!=o[t][4]&&(g=0==s,o[t][4]<128?(b=!0,_=o[t][4]):(b=!1,_=o[t][4]-128)),s=o[t][4]>128?o[t][4]:0;var x={number:y,Name:1,Pos:v,Speed:k,Delay:P,Loop_Time:_,Is_Loop_Start:g,Is_Loop_End:b,Music_State:L,Music_Number:e};c.push(G(x))}l=c.length;let e=0;_=-1;var F=!1,A=[[]],S=c[0].number;A[0]=[];for(let t=0;t<l;t++){S!=c[t].number&&(S=c[t].number,e++,A[e]=[]);var M=[];M.push(255),M.push(255),M.push(61),M.push(2),F||(M[4]=0),!F||c[t].Is_Loop_Start||c[t].Is_Loop_End||(M[4]=_+128),c[t].Is_Loop_End&&(F=!1,M[4]=_,_=0),c[t].Is_Loop_Start&&(F=!0,_=c[t].Loop_Time,M[4]=_+128);var I=0,U=0,O=0,C=0,D=0,N=0;for(let e=0;e<48;e++)e<8&&c[t].Pos[e]<0&&(I+=parseInt(Math.pow(2,7-e)),c[t].Pos[e]=-1*c[t].Pos[e]),e>=8&&e<16&&c[t].Pos[e]<0&&(U+=parseInt(Math.pow(2,15-e)),c[t].Pos[e]=-1*c[t].Pos[e]),e>=16&&e<24&&c[t].Pos[e]<0&&(O+=parseInt(Math.pow(2,23-e)),c[t].Pos[e]=-1*c[t].Pos[e]),e>=24&&e<32&&c[t].Pos[e]<0&&(C+=parseInt(Math.pow(2,31-e)),c[t].Pos[e]=-1*c[t].Pos[e]),e>=32&&e<40&&c[t].Pos[e]<0&&(D+=parseInt(Math.pow(2,39-e)),c[t].Pos[e]=-1*c[t].Pos[e]),e>=40&&e<48&&c[t].Pos[e]<0&&(N+=parseInt(Math.pow(2,47-e)),c[t].Pos[e]=-1*c[t].Pos[e]);M[5]=I,M[6]=U,M[7]=O,M[8]=C,M[9]=D,M[10]=N;for(let e=0;e<48;e++)M[e+11]=c[t].Pos[e];switch(M[59]=c[t].Speed,M[60]=c[t].Delay,c[t].Music_State){case 1:M[61]=parseInt(c[t].Music_Number/256),M[62]=parseInt(c[t].Music_Number%256);break;case 2:M[61]=parseInt(c[t].Music_Number/256),M[62]=parseInt(c[t].Music_Number%256);break;case 3:M[61]=252,M[62]=252;break;case 4:M[61]=251,M[62]=251;break}var T=0;for(let e=2;e<63;e++)T+=M[e];T%=256,M[63]=T,A[e].push(M)}console.log(A),l=a.length;for(let t=0;t<l;t++){let e=new Promise(((e,t)=>{setTimeout((()=>e()),50)}));await e;var W=a[t];console.log(W);var B=W.substring(0,4),R=W.substring(4);"地面::"==B?B="GroundAction/":"凌空::"==B&&(B="VolleyAction/"),R=B+R;var E=Array.from(u().encode(R,"utf8")),V=E.length,q=V+2,j=[];j[0]=255,j[1]=255,j[2]=q,j[3]=21;T=q+21;for(let t=0;t<V;t++)j.push(E[t]),T+=E[t];T%=256,j.push(T);var Z=new Uint8Array(j);const r=this.port.writable.getWriter();await r.write(Z);const o=await this.port.readable.getReader();var H=[],Y=!1;while(!Y){const{value:e,done:t}=await o.read();if(t){o.releaseLock();break}for(let r=0;r<e.length;r++)H[H.length]=e[r];for(let r=0;r<H.length;r++)if(255==H[r]&&255==H[r+1]){var $=H[r+3];21==$&&79==H[r+4]&&75==H[r+5]&&(Y=!0)}}let n=new Promise(((e,t)=>{setTimeout((()=>e()),50)}));await n,j[3]=20,j[j.length-1]=j[j.length-1]-1,Z=new Uint8Array(j),await r.write(Z),H=[],Y=!1;while(!Y){const{value:e,done:t}=await o.read();if(t){o.releaseLock();break}for(let r=0;r<e.length;r++)H[H.length]=e[r];for(let r=0;r<H.length;r++)if(255==H[r]&&255==H[r+1]){$=H[r+3];20==$&&79==H[r+4]&&75==H[r+5]&&(Y=!0)}}let l=new Promise(((e,t)=>{setTimeout((()=>e()),50)}));await l,j=[],T=0,R+=".sh",console.log(R),E=Array.from(u().encode(R,"gb2312")),V=E.length,q=V+2,j[0]=255,j[1]=255,j[2]=q,j[3]=23,T=q+23;for(let t=0;t<V;t++)j.push(E[t]),T+=E[t];T%=256,j.push(T),Z=new Uint8Array(j),await r.write(Z),H=[],Y=!1;while(!Y){const{value:e,done:t}=await o.read();if(t){o.releaseLock();break}for(let r=0;r<e.length;r++)H[H.length]=e[r];for(let r=0;r<H.length;r++)if(255==H[r]&&255==H[r+1]){$=H[r+3];23==$&&79==H[r+4]&&75==H[r+5]&&(Y=!0)}}let i=new Promise(((e,t)=>{setTimeout((()=>e()),50)}));await i,console.log(A[t]);for(let a=0;a<A[t].length;a++){let e=new Promise(((e,t)=>{setTimeout((()=>e()),150)}));await e;var K=new Uint8Array(A[t][a]);await r.write(K),H=[],Y=!1;while(!Y){const{value:e,done:t}=await o.read();if(t){o.releaseLock();break}for(let r=0;r<e.length;r++)H[H.length]=e[r];for(let r=0;r<H.length;r++)if(255==H[r]&&255==H[r+1]){$=H[r+3];2==$&&79==H[r+4]&&75==H[r+5]&&(console.log(r+" "+H),Y=!0)}}}await r.releaseLock(),await o.releaseLock()}}}}catch(t){console.error(t)}},async getActionName(){try{if(1==this.isLink){var e=Array.from(u().encode("GroundAction","gb2312")),t=e.length,r=t+2,a=[];a[0]=255,a[1]=255,a[2]=r,a[3]=26;var o=r+26;for(let r=0;r<t;r++)a.push(e[r]),o+=e[r];o%=256,a.push(o);var n=new Uint8Array(a);const f=this.port.writable.getWriter();await f.write(n);const w=await this.port.readable.getReader();var l=[],i=!1;while(!i){const{value:e,done:t}=await w.read();if(t){w.releaseLock();break}for(let r=0;r<e.length;r++)l[l.length]=e[r];for(let r=0;r<l.length;r++)if(255==l[r]&&255==l[r+1]&&4==l[r+2]&&250==l[r+3]&&79==l[r+4]&&75==l[r+5]&&152==l[r+6]){i=!0,l.slice(r,6);break}}var s=[];for(let e=0;e<l.length;e++)if(255==l[e]&&255==l[e+1]&&255!=l[e+2]&&26==l[e+3]){var c=l[e+2],p=[];for(let t=0;t<c-2;t++)p.push(l[e+4+t]);e=e+2+c;var h="地面::"+u().decode(p,"gb2312");s.push(h)}e=Array.from(u().encode("VolleyAction","gb2312")),t=e.length,r=t+2,a=[],a[0]=255,a[1]=255,a[2]=r,a[3]=26,o=r+26;for(let r=0;r<t;r++)a.push(e[r]),o+=e[r];o%=256,a.push(o),n=new Uint8Array(a),await f.write(n),l=[],i=!1;while(!i){const{value:e,done:t}=await w.read();if(t){w.releaseLock();break}for(let r=0;r<e.length;r++)l[l.length]=e[r];for(let r=0;r<l.length;r++)if(255==l[r]&&255==l[r+1]&&4==l[r+2]&&250==l[r+3]&&79==l[r+4]&&75==l[r+5]&&152==l[r+6]){i=!0,l.slice(r,6);break}}for(let e=0;e<l.length;e++)if(255==l[e]&&255==l[e+1]&&255!=l[e+2]&&26==l[e+3]){c=l[e+2],p=[];for(let t=0;t<c-2;t++)p.push(l[e+4+t]);e=e+2+c;h="凌空::"+u().decode(p,"gb2312");s.push(h)}await f.releaseLock(),await w.releaseLock(),this.vOpentions=s}}catch(f){console.error(f)}},async getAction(){try{if(1==this.isLink&&""!=this.selectedOption){var e=this.selectedOption.substring(0,4),t=this.selectedOption.substring(4);"地面::"==e?e="GroundAction/":"凌空::"==e&&(e="VolleyAction/"),t=e+t;var r=Array.from(u().encode(t,"gb2312")),a=r.length,o=a+3,n=[];n[0]=255,n[1]=255,n[2]=o,n[3]=22,n[4]=59;var l=o+22+59;for(let e=0;e<a;e++)n.push(r[e]),l+=r[e];l%=256,n.push(l);var i=new Uint8Array(n);const f=this.port.writable.getWriter();await f.write(i);const w=await this.port.readable.getReader();var s=[],c=!1;while(!c){const{value:e,done:t}=await w.read();if(t){w.releaseLock();break}for(let r=0;r<e.length;r++)s[s.length]=e[r];for(let r=0;r<s.length;r++)if(255==s[r]&&255==s[r+1]&&4==s[r+2]&&250==s[r+3]&&79==s[r+4]&&75==s[r+5]&&152==s[r+6]){c=!0,s.slice(r,6);break}}for(let e=0;e<s.length;e++)if(255==s[e]&&255==s[e+1]&&255!=s[e+2]&&22==s[e+3]){var p=s[e+2],h=[];for(let t=0;t<p-2;t++)h.push(s[e+4+t]);e=e+2+p,console.log(h)}await f.releaseLock(),await w.releaseLock()}}catch(f){console.error(f)}}}};const H=(0,p.Z)(Z,[["render",q]]);var Y=H;const $=(0,a._)("h3",null,"大黄蜂机器人通讯结构",-1),K=(0,a._)("p",null,"连接方式 : 串口",-1),X=(0,a._)("p",null,"配置参数baudRate : 115200",-1),z=(0,a._)("p",null,"配置参数parity : 0",-1),J=(0,a._)("p",null,"配置参数dataBits : 8",-1),Q=(0,a._)("p",null,"配置参数stopBits : 1",-1),ee=(0,a._)("label",null,[(0,a.Uk)(" 连接成功后，发送[0xFF, 0xFF, 0x02, 0xF5, 0xF7] 指令0xF5是进入PC编程模式 0xF7是(指令+数据)和%256的结果 "),(0,a._)("br"),(0,a.Uk)(" 发送后接收数据直到接收[0xFF,0xFF,0x04 0xF4,0x4F 0x4B,0x93] 当中的数据需要进行处理")],-1),te=(0,a._)("p",null,null,-1),re=(0,a._)("p",null,null,-1),ae=(0,a._)("label",null,"下载是将pc上的数据载入到机器人当中，这里用一个.shr机器人保存再本地的文件开始,下载的指令顺序是:删除(0x07),创建(0X06),下载(0x02)",-1),oe=(0,a._)("p",null,null,-1);function ne(e,t,r,o,n,l){const i=(0,a.up)("el-button");return(0,a.wg)(),(0,a.iD)(a.HY,null,[$,K,X,z,J,Q,(0,a.Wm)(i,{type:"primary",onClick:t[0]||(t[0]=e=>l.requestSerialPort())},{default:(0,a.w5)((()=>[(0,a.Uk)("连接")])),_:1}),ee,te,(0,a._)("input",{type:"file",onChange:t[1]||(t[1]=(...e)=>l.actionDownload&&l.actionDownload(...e))},null,32),re,ae,oe],64)}var le={data(){return{port:{},isLink:!1,initData:[],dataArr:[]}},methods:{async requestSerialPort(){try{const o=await navigator.serial.requestPort();if(null!=o){await o.open({baudRate:115200,parity:"none",dataBits:8,stopBits:1}),this.port=o;const n=new Uint8Array([255,255,2,245,247]),l=o.writable.getWriter();await l.write(n),await l.releaseLock();const i=await o.readable.getReader();this.isLink=!1;var e=[];while(1){if(1==this.isLink){i.releaseLock();break}const{value:a,done:o}=await i.read();if(o){i.releaseLock();break}for(let t=0;t<a.length;t++)e[e.length]=a[t];for(let n=0;n<e.length;n++)if(255==e[n]&&255==e[n+1]){var t=e[n+2],r=e[n+3];if(4==t&&245==r&&79==e[n+4]&&75==e[n+5]&&e[n+6]==(t+r+79+75)%256){this.isLink=!0;break}}}let s=0;for(let o=0;o<e.length;o++)if(255==e[o]&&255==e[o+1]){t=e[o+2],r=e[o+3];if(50==t&&245==r){var a=[];for(let t=0;t<48;t++)a[t]=e[o+t+4];o+=52,this.initData[s]=a,s++}}console.log(this.initData)}}catch(o){console.error(o)}},async actionDownload(e){try{const t=e.target.files[0],r=new FileReader;r.readAsText(t,"UTF-8"),r.onload=async e=>{const t=e.target.result,r=t.trim().split("\n").length;this.dataArr=[];for(let u=0;u<r;u++){const e=t.split("\r\n")[u].split(",")[0],r=e.split(/\s+/).map((e=>isNaN(e)?e:""==e?" ":Number(e)));this.dataArr.push(r)}if(1==this.isLink){var a=[],o=[],n=this.dataArr,l=n.length;for(let t=0;t<l;t++){var i=!1;" "==n[t][0]&&(i=!0),253==n[t][0]&&253==n[t][1]&&254==n[t][2]&&" "!=n[t][3]&&a.push(n[t][3]),1==i&&o.push(n[t])}var s=0;l=o.length;var c=[];for(let t=0;t<l;t++){var p=o[t][5],h=o[t][6],f=o[t][7],w=o[t][8],d=o[t][9],m=o[t][10];for(let e=0;e<8;e++){let r=p&Math.pow(2,7-e);0!=r&&(o[t][e+11]*=-1)}for(let e=0;e<8;e++){let r=h&Math.pow(2,7-e);0!=r&&(o[t][e+19]*=-1)}for(let e=0;e<8;e++){let r=f&Math.pow(2,7-e);0!=r&&(o[t][e+27]*=-1)}for(let e=0;e<8;e++){let r=w&Math.pow(2,7-e);0!=r&&(o[t][e+35]*=-1)}for(let e=0;e<8;e++){let r=d&Math.pow(2,7-e);0!=r&&(o[t][e+43]*=-1)}for(let e=0;e<8;e++){let r=m&Math.pow(2,7-e);0!=r&&(o[t][51]*=-1)}var _=0,g=!1,b=!1;0!=o[t][4]&&o[t][4]>128?_=o[t][4]-128:0!=o[t][4]&&o[t][4]>128?(_=o[t][4],g=!1,b=!0):0==o[t][4]&&(g=!1,b=!1);var v=[],y=o[t][3];for(let e=0;e<48;e++)v[e]=o[t][e+11];var k=o[t][59],P=o[t][60],L=0,x=-1,F=-1;251!=o[t][61]&&251!=o[t][62]&&252!=o[t][61]&&252!=o[t][62]?(F=256*o[t][61]+o[t][62],L=2):251==o[t][61]&&251==o[t][62]?L=4:252==o[t][61]&&252==o[t][62]&&(L=3),x=F,0!=o[t][4]&&(g=0==s,o[t][4]<128?(b=!0,_=o[t][4]):(b=!1,_=o[t][4]-128)),s=o[t][4]>128?o[t][4]:0;var A={number:y,Name:1,Pos:v,Speed:k,Delay:P,Loop_Time:_,Is_Loop_Start:g,Is_Loop_End:b,Music_State:L,Music_Number:x};c.push(G(A))}l=c.length;let e=0;_=-1;var S=!1,M=[[]],I=c[0].number;M[0]=[];for(let t=0;t<l;t++){I!=c[t].number&&(I=c[t].number,e++,M[e]=[]);var U=[];U.push(255),U.push(255),U.push(61),U.push(2),S||(U[4]=0),!S||c[t].Is_Loop_Start||c[t].Is_Loop_End||(U[4]=_+128),c[t].Is_Loop_End&&(S=!1,U[4]=_,_=0),c[t].Is_Loop_Start&&(S=!0,_=c[t].Loop_Time,U[4]=_+128);var O=0,C=0,D=0,N=0,T=0,W=0;for(let e=0;e<48;e++)e<8&&c[t].Pos[e]<0&&(O+=parseInt(Math.pow(2,7-e)),c[t].Pos[e]=-1*c[t].Pos[e]),e>=8&&e<16&&c[t].Pos[e]<0&&(C+=parseInt(Math.pow(2,15-e)),c[t].Pos[e]=-1*c[t].pos[e]),e>=16&&e<24&&c[t].Pos[e]<0&&(D+=parseInt(Math.pow(2,23-e)),c[t].Pos[e]=-1*c[t].Pos[e]),e>=24&&e<32&&c[t].Pos[e]<0&&(N+=parseInt(Math.pow(2,31-e)),c[t].Pos[e]=-1*c[t].Pos[e]),e>=32&&e<40&&c[t].Pos[e]<0&&(T+=parseInt(Math.pow(2,39-e)),c[t].Pos[e]=-1*c[t].Pos[e]),e>=40&&e<48&&c[t].Pos[e]<0&&(W+=parseInt(Math.pow(2,47-e)),c[t].Pos[e]=-1*c[t].Pos[e]);U[5]=O,U[6]=C,U[7]=D,U[8]=N,U[9]=T,U[10]=W;for(let e=0;e<48;e++)U[e+11]=c[t].Pos[e];switch(U[59]=c[t].Speed,U[60]=c[t].Delay,c[t].Music_State){case 1:U[61]=parseInt(c[t].Music_Number/256),U[62]=parseInt(c[t].Music_Number%256);break;case 2:U[61]=parseInt(c[t].Music_Number/256),U[62]=parseInt(c[t].Music_Number%256);break;case 3:U[61]=252,U[62]=252;break;case 4:U[61]=251,U[62]=251;break}var B=0;for(let e=2;e<63;e++)B+=U[e];B%=256,U[63]=B,M[e].push(U)}l=a.length,console.log(M);for(let t=0;t<l;t++){let e=new Promise(((e,t)=>{setTimeout((()=>e()),50)}));await e;var R=a[t],E=Array.from(u().encode(R,"utf8")),V=E.length,q=V+2,j=[];B=0;j[0]=255,j[1]=255,j[2]=q,j[3]=7,B=q+7;for(let t=0;t<V;t++)j.push(E[t]),B+=E[t];B%=256,j.push(B);var Z=new Uint8Array(j);const r=this.port.writable.getWriter();await r.write(Z);const o=await this.port.readable.getReader();let n=new Promise(((e,t)=>{setTimeout((()=>e()),50)}));await n,j[3]=6,j[j.length-1]=j[j.length-1]-1,Z=new Uint8Array(j),await r.write(Z),[],!1;let l=new Promise(((e,t)=>{setTimeout((()=>e()),50)}));await l;for(let a=0;a<M[t].length;a++){let e=new Promise(((e,t)=>{setTimeout((()=>e()),150)}));await e;var H=new Uint8Array(M[t][a]);console.log(H),await r.write(H),[],!1}await r.releaseLock(),await o.releaseLock()}console.log("上传完成")}}}catch(t){}}}};const ie=(0,p.Z)(le,[["render",ne]]);var se=ie;function ue(e,t,r,a,o,n){return null}var ce={data(){}};const pe=(0,p.Z)(ce,[["render",ue]]);var he=pe;const fe=(0,o.p7)({mode:"hash",history:(0,o.PO)("/"),routes:[{path:"/",name:"HomePage",component:f},{path:"/Convoy_Seven",name:"Convoy_Seven",component:Y},{path:"/Bumblebee",name:"/Bumblebee",component:se},{path:"/SteelCable",name:"/SteelCable",component:he}]});var we=fe,de=r(3365);r(4415);const me={id:"app"};function _e(e,t){const r=(0,a.up)("router-view");return(0,a.wg)(),(0,a.iD)("div",me,[(0,a.Wm)(r)])}const ge={},be=(0,p.Z)(ge,[["render",_e]]);var ve=be;const ye=(0,a.ri)(ve);ye.use(we),ye.use(de.Z),ye.mount("#app")},5832:function(){}},t={};function r(a){var o=t[a];if(void 0!==o)return o.exports;var n=t[a]={exports:{}};return e[a].call(n.exports,n,n.exports,r),n.exports}r.m=e,function(){var e=[];r.O=function(t,a,o,n){if(!a){var l=1/0;for(c=0;c<e.length;c++){a=e[c][0],o=e[c][1],n=e[c][2];for(var i=!0,s=0;s<a.length;s++)(!1&n||l>=n)&&Object.keys(r.O).every((function(e){return r.O[e](a[s])}))?a.splice(s--,1):(i=!1,n<l&&(l=n));if(i){e.splice(c--,1);var u=o();void 0!==u&&(t=u)}}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[a,o,n]}}(),function(){r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,{a:t}),t}}(),function(){r.d=function(e,t){for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};r.O.j=function(t){return 0===e[t]};var t=function(t,a){var o,n,l=a[0],i=a[1],s=a[2],u=0;if(l.some((function(t){return 0!==e[t]}))){for(o in i)r.o(i,o)&&(r.m[o]=i[o]);if(s)var c=s(r)}for(t&&t(a);u<l.length;u++)n=l[u],r.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return r.O(c)},a=self["webpackChunkrobot_comm_model"]=self["webpackChunkrobot_comm_model"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=r.O(void 0,[998],(function(){return r(6514)}));a=r.O(a)})();
//# sourceMappingURL=app.e3e72cbc.js.map